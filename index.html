<script>

let provider;
let signer;
let userAddress;

// ====== CONTRACT DETAILS ======
const stakingAddress = "YOUR_STAKING_CONTRACT";
const tokenAddress   = "YOUR_TOKEN_CONTRACT";

// ABI minimal
const stakingABI = [
"function stake(uint256 amount) public",
"function getStake(address user) view returns(uint256)",
"function claim() public"
];

constnconst tokenABI = [
"function approve(address spender,uint256 amount) public returns(bool)",
"function balanceOf(address account) view returns(uint256)"
];

// ==============================

async function connectWallet(){

if(window.ethereum){

provider = new ethers.providers.Web3Provider(window.ethereum);
await provider.send("eth_requestAccounts", []);
signer = provider.getSigner();
userAddress = await signer.getAddress();

document.getElementById("wallet").innerHTML =
"Connected: " + userAddress;

document.getElementById("dash").style.display="block";

loadBalance();

}else{

const dapp = window.location.href.replace("https://","");
window.location.href =
"https://metamask.app.link/dapp/" + dapp;

}

}

// ==============================
// LOAD TOKEN BALANCE
// ==============================
async function loadBalance(){

const token = new ethers.Contract(tokenAddress, tokenABI, provider);
let bal = await token.balanceOf(userAddress);

bal = ethers.utils.formatUnits(bal,18);

document.getElementById("balance").innerHTML =
"DX Balance: " + bal;

}

// ==============================
// STAKE FUNCTION
// ==============================
async function stakeDX(){

const amount = prompt("Enter DX amount to stake:");

const token = new ethers.Contract(tokenAddress, tokenABI, signer);
const staking = new ethers.Contract(stakingAddress, stakingABI, signer);

const wei = ethers.utils.parseUnits(amount,18);

// approve
let tx1 = await token.approve(stakingAddress, wei);
await tx1.wait();

// stake
let tx2 = await staking.stake(wei);
await tx2.wait();

alert("Staked Successfully");

}

// ==============================
// CLAIM REWARD
// ==============================
async function claimReward(){

const staking = new ethers.Contract(stakingAddress, stakingABI, signer);

let tx = await staking.claim();
await tx.wait();

alert("Reward Claimed");

}

</script>
